<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta http-equiv=x-ua-compatible content="ie=edge"><title>Notes - Vladimir Varankin</title><link rel=canonical href=https://vladimir.varank.in/notes/><link rel=alternate type=application/rss+xml href=https://vladimir.varank.in/notes/index.xml title="Notes from Vladimir Varankin"><meta property="og:title" content="Notes"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://vladimir.varank.in/notes/"><style>:root{--background-color:#fff;--text-color:rgb(19, 19, 19);--text-underline-color:rgba(19, 19, 19, 0.5);--header-color:#111;--hr-color:rgb(143, 150, 163);--link-color:rgb(0, 16, 161);--link-underline-color:rgba(0, 16, 161, 0.3);--link-active-color:rgb(231, 19, 19);--link-active-underline-color:rgba(231, 19, 19, 0.7);--tag-color:rgb(85, 63, 63);--tag-underline-color:rgba(85, 63, 63, 0.5)}html{font-size:16px;height:100%;margin:0;padding:0}body{background:var(--background-color);color:var(--text-color);display:grid;grid-template-rows:auto 1fr auto;font-family:Charter,Georgia,serif;font-size:1.1rem;line-height:1.3;margin:5px 1%;margin:5px max(7px,1%);margin:5px clamp(7px,1.5vw,14px);min-height:calc(100vh - 10px)}h1,h2,h3,h4,h5,h6{color:var(--header-color);font-family:Athelas,Georgia,serif;line-height:1;margin:1.5em 0 .7em}h1{font-size:40px;margin:.5em 0 .2em}a{color:#0010a1;color:var(--link-color);text-decoration-color:var(--link-underline-color);text-decoration-thickness:.04em;text-underline-offset:.1em}a:hover,a:active{color:#be0000;color:var(--link-active-color);text-decoration-color:var(--link-active-underline-color)}ul,ol{box-sizing:border-box;max-width:760px;padding:0}ol{padding-left:1.2em}ul>li{list-style:none;margin:.5em 0}figure{margin:0;margin-block-start:1em;margin-block-end:1em;padding:0}figcaption{font-size:16px;font-style:italic}pre{line-height:1.1}code{font-family:sf mono,Menlo,Consolas,monospace;font-size:16px}pre code{font-size:14px;tab-size:2}@media screen and (min-device-width:900px){pre{margin:2em 1em}pre code{font-size:15px;tab-size:4}}hr{color:var(--hr-color);border:none;margin:.5em 0;width:90%}hr::after{content:'¶';display:block;font-size:14px;text-align:center}.site-nav{display:flex;flex-wrap:wrap;letter-spacing:.3em;padding-bottom:16px}.site-nav a,.site-nav span{margin-right:.6em;letter-spacing:0}.site-nav-item-active{color:var(--link-active-color);text-decoration-color:var(--link-active-underline-color)}.site-content{font-size:19px;max-width:940px}.site-content img{max-width:100%;max-width:calc(100vw - 15px)}.site-content pre{max-width:calc(100vw - 1em);overflow:visible;overflow-x:scroll}@media screen and (min-width:900px){.site-content pre{max-width:calc(100vw - 4em);overflow-x:visible}}.site-footer{font-size:14px;margin:50px 0 0}.site-footer a{color:var(--text-color);text-decoration-color:inherit;text-decoration-color:var(--text-underline-color)}.main-head{display:flex;align-items:baseline;gap:8px}.main-head-meta{font-size:16px;margin:0;padding:0}.main-head-meta a{color:var(--text-color);text-decoration-color:inherit;text-decoration-color:var(--text-underline-color);margin:0 5px 0 0}.main-head-meta a:hover,.main-head-meta a:active{color:var(--link-active-color);text-decoration-color:var(--link-active-underline-color)}.article{margin:0 0 50px}.article:last-child{margin-bottom:0}.section-head{font-size:28px}.section-head h1,.section-head h2{font-size:1em;margin-top:1em}.section-head h2{margin-bottom:0}.snippet{margin:0 0 40px}.snippet:last-of-type{margin:0}.snippet p{margin:0 0 .3em}.snippet-head h2{font-size:21px;margin:1em 0 .2em}.meta{font-size:14px;line-height:1;padding:5px 0 0}.tag{color:var(--tag-color);text-decoration-color:var(--tag-underline-color);margin:0 0 0 7px;text-transform:lowercase}.meta-topics-list{line-height:1.4;padding:34px 0 0}.meta-topics-list .tag{display:inline-block;margin:0 1ex 0 0}.pagination{display:flex;flex-wrap:nowrap}.page-item{display:inline-block;line-height:32px;margin-right:1em}.glitch:before{background:var(--background-color);position:absolute;content:attr(data-text);clip:rect(0,900px,0,0);animation:glitch-anim 2s infinite linear alternate-reverse;margin-left:-5px;text-shadow:1px 0 red}@media(prefers-reduced-motion){.glitch:before{display:none}}@keyframes glitch-anim{0%{clip:rect(3px,9999px,93px,0)}5%{clip:rect(53px,9999px,78px,0)}10%{clip:rect(10px,9999px,75px,0)}15%{clip:rect(32px,9999px,40px,0)}20%{clip:rect(65px,9999px,62px,0)}25%{clip:rect(31px,9999px,14px,0)}30%{clip:rect(94px,9999px,87px,0)}35%{clip:rect(81px,9999px,41px,0)}40%{clip:rect(45px,9999px,50px,0)}45%{clip:rect(82px,9999px,41px,0)}50%{clip:rect(71px,9999px,3px,0)}55%{clip:rect(75px,9999px,60px,0)}60%{clip:rect(20px,9999px,49px,0)}65%{clip:rect(67px,9999px,92px,0)}70%{clip:rect(47px,9999px,55px,0)}75%{clip:rect(63px,9999px,90px,0)}80%{clip:rect(70px,9999px,92px,0)}85%{clip:rect(41px,9999px,60px,0)}90%{clip:rect(56px,9999px,79px,0)}95%{clip:rect(21px,9999px,68px,0)}100%{clip:rect(15px,9999px,72px,0)}}</style></head><body><nav class=site-nav><a href=/ class=glitch data-text="Vladimir Varankin">Vladimir Varankin</a>
<a href=/notes/ class=site-nav-item-active>Notes</a>
<a href=/publications/>Publications</a>
<span>·</span>
<a href=https://github.com/narqo>GitHub</a>
<a href=https://twitter.com/tvii>Twitter</a>
<a href=https://t.me/varankinv>Telegram</a>
<a href=https://keybase.io/varankinv>Keybase</a></nav><main class=site-content><header class=main-head><h1>Notes</h1>/ <menu class=main-head-meta><a href=/notes/berlin/>Berlin</a>
<a href=/notes/go/>Go</a>
<a href=/notes/homelab/>Homelab</a>
<a href=/notes/kubernetes/>Kubernetes</a>
<a href=/notes/all/>Everything</a></menu></header><article class=article data-weight=0 data-word-count=400 data-reading-time=2><header class=section-head><h2><a href=/notes/2023/05/env-variables-you-will-likely-find-set-in-my-kubernetes-deployments/>Env variables, you will (likely) find set in my Kubernetes deployments</a></h2></header><p>Kubernetes allows us to pass the values declared in a Pod&rsquo;s manifest, to its containers via environment variables (<a href=https://kubernetes.io/docs/tasks/inject-data-application/environment-variable-expose-pod-information/>docs</a>). A typical situation, where I find this handy is when I run a Go application in a Pod.</p><p>As discussed in the previous note, out of the box, <a href=/notes/2023/01/go-runtime-vs-cfs-quota/>Go runtime isn&rsquo;t aware if it runs inside a container</a>. This can lead to confusing situations, when the runtime adjusts its behaviour, after observing the resources (CPU and memory) available on the cluster&rsquo;s node, instead of the resources, a developer or an operator restricted the deployment with.</p><p><a href=/notes/2023/05/env-variables-you-will-likely-find-set-in-my-kubernetes-deployments/>Keep reading…</a></p><footer class=meta><time datetime=2023-05-01T12:00:00Z>May 1, 2023</time><a class=tag href=/notes/go/>Go</a><a class=tag href=/notes/kubernetes/>kubernetes</a></footer></article><article class=article data-weight=0 data-word-count=800 data-reading-time=4><header class=section-head><h2><a href=/notes/2023/01/go-runtime-vs-cfs-quota/>Go runtime vs CFS quota</a></h2></header><p>As of today, the Go runtime isn&rsquo;t aware if it runs inside a container under the resource constraints (CPU or memory). The runtime sees the resources available for the container&rsquo;s underlying host OS, e.g. the VM where the container runs, and tries to optimize its behaviour base on what it sees. For container runtimes on Linux, which implements the CPU restrictions via CFS (&ldquo;Completely Fair Scheduler&rdquo;), a mismatch in what the application thinks is has, and what the OS allows to use, can lead to the poor performance of the application after the unexpected throttling.</p><p>For example, a Go application, that runs in a container, constrained with 0.5 CPU, running on a host with 2 CPU, will observe 2 available CPU cores. That is the application&rsquo;s calls to <a href=https://pkg.go.dev/runtime#NumCPU><code>runtime.NumCPU()</code></a> and <a href=https://pkg.go.dev/runtime#GOMAXPROCS><code>runtime.GOMAXPROCS()</code></a> will get us &ldquo;2&rdquo;. Because the Go runtime is optimized for the maximum utilization of the available compute under the concurrent workload, the goroutines it spawns are distributed to the internal thread pool, created with the assumption of two available CPU cores. This causes the application to throttle after the sum of the time it spend on the CPU cores per CFS period become equals to the quota of the container. With <a href=https://www.kernel.org/doc/html/latest/scheduler/sched-bwc.html#management>the default CFS period</a> 100ms, the CFS quota of this container 0.5 CPU, and two threads running on different CPU cores, the application is throttled after 25ms every 100ms.</p><p><a href=/notes/2023/01/go-runtime-vs-cfs-quota/>Keep reading…</a></p><footer class=meta><time datetime=2023-01-12T12:00:00Z>January 12, 2023</time><a class=tag href=/notes/go/>Go</a><a class=tag href=/notes/kubernetes/>kubernetes</a><a class=tag href=/notes/linux/>linux</a></footer></article><article class=article data-weight=0 data-word-count=100 data-reading-time=1><header class=section-head><h2><a href=/notes/2022/12/bookmarks-10/>Bookmarks (issue 10)</a></h2></header><p><a href="https://www.youtube.com/watch?v=ZZkMN6cbL-U">The 22 BEST Basslines of 2022</a> (Patrick Hunter).</p><p><a href=https://boyter.org/posts/how-i-built-my-own-index-for-searchcode/>Building a custom code search index in Go for searchcodecom</a> (<a href=https://twitter.com/boyter>Ben Boyter</a>).</p><p><a href=https://medium.com/directeam/kubernetes-resources-under-the-hood-part-3-6ee7d6015965>Kubernetes resources under the hood</a>. This year was rich for deep tech articles and talks, that explain how CPU requests and limits work in Kubernetes. This three-part series is no exception.</p><p><a href=https://twitter.com/ID_AA_Carmack/status/1603931899810004994>John Carmack on resigning from Meta</a>. A post that spawned many intresting opinions on the internet: &ldquo;You can&rsquo;t have top people in X (performance, security, whatever) work for you and only half-care about X at the same time. They will move&rdquo;.</p><footer class=meta><time datetime=2022-12-31T12:00:00Z>December 31, 2022</time><a class=tag href=/notes/bookmarks/>bookmarks</a><a class=tag href=/notes/go/>Go</a><a class=tag href=/notes/kubernetes/>kubernetes</a><a class=tag href=/notes/music/>music</a></footer></article><article class=article data-weight=0 data-word-count=400 data-reading-time=2><header class=section-head><h2><a href=/notes/2022/12/how-go-test-runs-tests/>How "go test" runs tests</a></h2></header><p>When I run <code>go test ./foo</code>, Go toolchain performs several tricks under the hood.</p><p>First — skipping the intermediate preparation steps, like parsing the command line flags and checking for cached results — the toolchain generates a package <code>main</code>, which will run all <code>TestXxx</code> functions for a package under the test. Then it compiles a testing-binary, that includes the generated code, and the code of the package and its _test.go files.</p><p>The steps above are <em>somewhere</em> equivalent to running the following command:</p><pre tabindex=0><code>&gt; go test -c -o foo.test ./foo

# The resulting &#34;foo.test&#34; is indeed an executable
&gt; file foo.test
foo.test: Mach-O 64-bit executable x86_64
</code></pre><p>This binary includes a generated function &ldquo;main&rdquo;, that, eventually, calls the packages <code>TestMain(m *testing.M)</code> (if one exists), and executes all the <code>TestXxx(t *testing.T)</code> functions, which the toolchain found during the code-generation.</p><p>For the details of how the generated &ldquo;main&rdquo; looks like, refer to the source code of <a href=https://github.com/golang/go/blob/release-branch.go1.19/src/cmd/go/internal/load/test.go>the internal package &ldquo;load&rdquo;</a>.</p><p>Next, the toolchain executes the built binary, setting the current working directory to the path of the original package <code>foo</code>, which is equivalent to running the following:</p><pre tabindex=0><code>&gt; cd ./foo
&gt; ./../foo.test
</code></pre><p>The important (and sometimes not obvious) part is that Go toolchain builds a dedicated binary for every package, under the testing scope. That is, in the example above, the testing binary contains only the code of the package &ldquo;foo&rdquo;, its dependencies, and the code in its _test.go files. If we ran the tests for several packages — <code>go test ./pkg/...</code> — the toolchain will generate, built and execute individual binaries for every package below <code>pkg/</code>. This makes the testing of each package fully-isolated.</p><p>There are lots of other things happening underneath, including code coverage, benchmarking, etc. Have a look through the documentation under <code>go help test</code> and <code>go help testflag</code>, for some more details.</p><footer class=meta><time datetime=2022-12-15T12:00:00Z>December 15, 2022</time><a class=tag href=/notes/go/>Go</a></footer></article><article class=article data-weight=0 data-word-count=100 data-reading-time=1><header class=section-head><h2><a href=/notes/2022/11/bookmarks-9/>Bookmarks (issue 9)</a></h2></header><p><a href=https://kubernetes.io/blog/2022/11/18/upcoming-changes-in-kubernetes-1-26/>Kubernetes removals, deprecations, and major changes in 1.26</a>.</p><p><a href=https://medium.com/@kewynakshlley/performance-evaluation-of-the-autoscaling-strategies-vertical-and-horizontal-using-kubernetes-42d9a1663e6b>Performance evaluation of autoscaling strategies in Kubernetes</a> (<a href=https://twitter.com/kewynakshlley>Kewyn Akshlley</a>). tl;dr; After comparing the performance of horizontal and vertical autoscaling using synthetic load, the horizontal autoscaling seems more efficient, reacts faster to the load variation, and results in a lower impact on the application&rsquo;s response time.</p><p><a href=https://changelog.com/gotime/257>How Pinterest delivers software at scale</a> (Go Time, podcast). A very refreshing discussion about real-world technical challenges large organizations face.</p><p><a href=https://www.se-radio.net/2022/11/episode-539-adam-dymitruk-on-event-modeling/>Adam Dymitruk on Event Modeling</a> (Software Engineering Radio, podcast). <a href=https://eventmodeling.org/posts/what-is-event-modeling/>Event Modeling: what is it?</a></p><footer class=meta><time datetime=2022-11-30T12:00:00Z>November 30, 2022</time><a class=tag href=/notes/bookmarks/>bookmarks</a><a class=tag href=/notes/go/>Go</a><a class=tag href=/notes/kubernetes/>kubernetes</a></footer></article><article class=article data-weight=0 data-word-count=200 data-reading-time=1><header class=section-head><h2><a href=/notes/2022/10/bookmarks-8/>Bookmarks (issue 8)</a></h2></header><p><a href=https://changelog.com/podcast/510>Taking Postgres serverless</a> (Changelog). <a href="https://www.youtube.com/watch?v=rES0yzeERns">Neon: Serverless PostgreSQL</a> (Heikki Linnakangas @ Carnegie Mellon University).</p><p><a href=https://brooker.co.za/blog/2022/04/11/simulation.html>Simple simulations for system builders</a> (<a href=https://twitter.com/MarcJBrooker>Marc Brooker</a>). System designers care about questions like &ldquo;How will the system behave under overload?&rdquo; or &ldquo;How sensitive is the design to latency?&rdquo;. By &ldquo;writing small simulators that simulate the behaviour of simple models&rdquo;, Marc shows an approach to explore and reason about the possible answers to such questions.</p><p><a href=https://fasterthanli.me/articles/the-http-crash-course-nobody-asked-for>The HTTP crash course nobody asked for</a>.</p><p><a href=https://www.industrialempathy.com/posts/design-docs-at-google/>Design docs at Google</a>. When not to write a design doc: A clear indicator that a doc might <em>not</em> be necessary is when a design doc is an implementation manual, that doesn&rsquo;t go into trade-offs, alternatives, and explanation of the decision-making; — write the actual application instead.</p><footer class=meta><time datetime=2022-10-31T12:00:00Z>October 31, 2022</time><a class=tag href=/notes/bookmarks/>bookmarks</a><a class=tag href=/notes/neondatabase/>neondatabase</a><a class=tag href=/notes/postgresql/>postgresql</a><a class=tag href=/notes/random/>random</a></footer></article><article class=article data-weight=0 data-word-count=200 data-reading-time=1><header class=section-head><h2><a href=/notes/2022/09/bookmarks-7/>Bookmarks (issue 7)</a></h2></header><p><a href=https://www.acquired.fm/episodes/amazon-com>The complete history and strategy of Amazon.com</a> and <a href=https://www.acquired.fm/episodes/amazon-web-services>The complete history and strategy of AWS</a> (Acquired podcast).
In the world, where the growth of storages is massively outpacing the improvements in the speed of the Internet, a database is the most sticky technology. That&rsquo;s how AWS locks the enterprises in: it’s impossible to migrate the enterprise-grade of data out of AWS (&ldquo;It took thirty years for Amazon to migrate off Oracle to AWS&rdquo;).</p><p><a href="https://www.youtube.com/playlist?list=PLSE8ODhjZXjaKScG3l0nuOiDTTqpfnWFf">CMU Intro to Database systems / Fall 2022</a> (Carnegie Mellon University); <a href=https://www.qwertee.io/blog/postgresql-b-tree-index-explained-part-1/>PostgreSQL B-Tree index explained, pt. 1</a> (Qwertee).</p><p><a href=https://aws.amazon.com/blogs/database/build-a-cqrs-event-store-with-amazon-dynamodb/>Build a CQRS event store with Amazon DynamoDB</a> (AWS).</p><footer class=meta><time datetime=2022-09-30T12:00:00Z>September 30, 2022</time><a class=tag href=/notes/bookmarks/>bookmarks</a><a class=tag href=/notes/aws/>aws</a><a class=tag href=/notes/postgresql/>postgresql</a></footer></article><article class=article data-weight=0 data-word-count=100 data-reading-time=1><header class=section-head><h2><a href=/notes/2022/09/working-on-a-new-thing/>Working on a new thing</a></h2></header><p>Number of developers will tell you, they prefer building &ldquo;a new thing&rdquo;, rather than maintaining existing &ldquo;legacy&rdquo; projects.</p><p>While working on &ldquo;green field&rdquo;, &ldquo;day zero&rdquo; projects can definitely be fun, they rarely feel <em>real</em> to me. The &ldquo;real&rdquo; project lives in production. It has users. It has load. It demands improvement.</p><p>You can&rsquo;t improve &ldquo;a new thing&rdquo;.</p><footer class=meta><time datetime=2022-09-08T12:00:00Z>September 8, 2022</time><a class=tag href=/notes/random/>random</a></footer></article><article class=article data-weight=0 data-word-count=100 data-reading-time=1><header class=section-head><h2><a href=/notes/2022/08/bookmarks-6/>Bookmarks (issue 6)</a></h2></header><p><a href="https://www.youtube.com/watch?v=x9_9iaVszpM">Kubernetes antipatterns: CPU Limits</a>. Always define CPU requests; never define CPU limits.</p><p><a href=https://www.depesz.com/2021/06/20/explaining-the-unexplainable-part-6-buffers/>Explaining the unexplainable: buffers in PostgreSQL</a>. Shared buffers are those, which&rsquo;re&rsquo; &ldquo;shared&rdquo; between several DB sessions, i.e. data pages, indices, etc; local buffers, are &ldquo;local&rdquo; to a session, i.e. for temporal tables; temp buffers are for intermediate objects, i.e. when the DBMS does hashing and sorting.</p><p><a href=https://www.geekabyte.io/2022/08/rust-iterator-pattern-with-iter.html>Rust Iterator pattern with <code>iter()</code>, <code>into_iter()</code> and <code>iter_mut()</code> methods</a>.</p><p><a href=https://github.com/golang/go/discussions/54245>Standard iterator interface in Go</a> (Ian Lance Taylor via GitHub Discussions).</p><footer class=meta><time datetime=2022-08-31T12:00:00Z>August 31, 2022</time><a class=tag href=/notes/bookmarks/>bookmarks</a><a class=tag href=/notes/go/>Go</a><a class=tag href=/notes/kubernetes/>kubernetes</a><a class=tag href=/notes/postgresql/>postgresql</a><a class=tag href=/notes/rust/>rust</a></footer></article><article class=article data-weight=0 data-word-count=100 data-reading-time=1><header class=section-head><h2><a href=/notes/2022/08/best-practices/>Best practices</a></h2></header><p>Before jumping on the &ldquo;best practices of software engineering&rdquo; train, after reading the classics, or someone&rsquo;s re-post on social media, ask what was the context, in which these &ldquo;best practices&rdquo; were established. Some of those made sense in the environment, where the product&rsquo;s release cycle has been measured with months. But that doesn&rsquo;t mean they make sense, when we ship/fix/ship/new-requirements/ship/update/ship the product several times every week.</p><footer class=meta><time datetime=2022-08-22T12:00:00Z>August 22, 2022</time><a class=tag href=/notes/random/>random</a></footer></article><article class=article data-weight=0 data-word-count=200 data-reading-time=1><header class=section-head><h2><a href=/notes/2022/07/bookmarks-5/>Bookmarks (issue 5)</a></h2></header><p><a href=https://www.youtube.com/user/devinebass>Scott&rsquo;s Bass Lessons</a> and <a href=https://www.youtube.com/c/BassBuzz>BassBuzz</a> on YouTube. I&rsquo;m learning how to play bass guitar 🎸 now. So far, these two channels were the most helpful with both the practice lessons, and the inspiration to move forward.</p><p><a href=https://youtu.be/A_mstzRGfIE>Event-driven architecture done right</a> (Tim Berglung, Devoxx Poland 2021). Try to learn what you&rsquo;re trying to do, before you elaborate the architecture, if uncertainty is very high, and you don’t know exactly what businesses are asking. Just start with something (architecturally) simple.</p><p><a href=https://www.usenix.org/system/files/atc22-vig.pdf>Amazon DynamoDB: A Scalable, Predictably Performant, and Fully Managed NoSQL Database Service</a> (whitepaper). <a href=https://brooker.co.za/blog/2022/07/12/dynamodb.html>The analysis of the paper</a> (Marc Brooker).</p><p><a href=https://www.acquired.fm/episodes/the-playbook-lessons-from-200-company-stories>Acquired&rsquo;s lessons learned from 200 company stories</a>: optimism always wins (Sony); nothing can stop the will to survive (Nvidia); it&rsquo;s never too late (TSMC); focus on what makes your beer taste better (Amazon and all utility companies); don&rsquo;t be talent — own the business (Oprah, Tail Swift); you’ll get the partners you ask for (Amazon&rsquo;s &ldquo;If you’re not on my bus, get off&rdquo;), and more.</p><footer class=meta><time datetime=2022-07-31T12:00:00Z>July 31, 2022</time><a class=tag href=/notes/bookmarks/>bookmarks</a><a class=tag href=/notes/dynamodb/>dynamodb</a><a class=tag href=/notes/random/>random</a></footer></article><article class=article data-weight=0 data-word-count=200 data-reading-time=1><header class=section-head><h2><a href=/notes/2022/06/bookmarks-4/>Bookmarks (issue 4)</a></h2></header><p><a href=https://tip.golang.org/doc/go1.19>Go 1.19beta1</a>. As usual, lots of good improvements in the language&rsquo;s runtime and the compiler, with one particularly interesting addition being the new &ldquo;knob&rdquo; <code>runtime/debug.SetMemoryLimit</code>.</p><p><a href=https://www.grammarly.com/blog/gender-neutral-language/>How to use gender-neutral language at work and in life</a> (Grammarly). &ldquo;Luckily, the English language is relatively gender-neutral in many respects&rdquo; [at least, when compared to Russian and German languages].</p><p><a href=https://developer.apple.com/videos/play/wwdc2022/10092>Meet passkeys</a> (Apple) and <a href="https://www.youtube.com/watch?v=mjHIt9lDBgA">Everything you want to know about WebAuthn</a> (OktaDev). As you can guess, I&rsquo;m very excited with Apple stepping onto the path to a passwordless future, while betting on WebAuthn standard.</p><p><a href=https://developer.apple.com/videos/play/wwdc2022/10077/>Replace CAPTCHAs with Private Access Tokens</a> (Apple),
<a href=https://www.fastly.com/blog/private-access-tokens-stepping-into-the-privacy-respecting-captcha-less>Private Access Tokens: stepping into the privacy-respecting, CAPTCHA-less future we were promised</a> (Fastly),
<a href=https://blog.cloudflare.com/eliminating-captchas-on-iphones-and-macs-using-new-standard/>Private Access Tokens: eliminating CAPTCHAs on iPhones and Macs with open standards</a> (Cloudflare).</p><footer class=meta><time datetime=2022-06-30T12:00:00Z>June 30, 2022</time><a class=tag href=/notes/bookmarks/>bookmarks</a><a class=tag href=/notes/apple/>apple</a><a class=tag href=/notes/passkeys/>passkeys</a><a class=tag href=/notes/go/>Go</a><a class=tag href=/notes/english/>english</a><a class=tag href=/notes/random/>random</a></footer></article><article class=article data-weight=0 data-word-count=200 data-reading-time=1><header class=section-head><h2><a href=/notes/2022/05/bookmarks-3/>Bookmarks (issue 3)</a></h2></header><p><a href=https://exercism.org/tracks/rust>Rust tracks on Exercism</a>. More than 100 coding exercises to learn <a href=https://www.rust-lang.org/>Rust</a> through practice.</p><p><a href=https://www.postgresql.org/about/news/postgresql-anonymizer-10-privacy-by-design-for-postgres-2452/>PostgreSQL Anonymizer 1.0</a>. A PostgreSQL extension for declarative data masking (<a href=https://postgresql-anonymizer.readthedocs.io/en/latest/>docs and examples</a>).</p><p><a href=https://postgrespro.com/blog/pgsql/5969493>Queries in PostgreSQL: 4. Index scan</a> (Postgres Pro). An in-depth overview of how PostgreSQL decides if it will use an index.
One particular thing I had no idea about before I read the article was that &ldquo;The Index Scan cost is highly dependent on the <em>correlation</em> between the physical order of the tuples on disk and the order in which the access method returns the IDs&rdquo;. That explains several cases from my own experience, where postgres kept using &ldquo;unexpected&rdquo; sequential scans, after we added &ldquo;another index&rdquo; to the database.</p><p><a href=https://www.micahlerner.com/2022/04/24/monarch-googles-planet-scale-in-memory-time-series-database.html>Monarch: Google’s planet-scale in-memory time series database</a> (<a href=https://twitter.com/micahlerner>Micah Lerner</a>). A review of the paper (<a href=https://storage.googleapis.com/pub-tools-public-publication-data/pdf/d84ab6c93881af998de877d0070a706de7bec6d8.pdf>PDF</a>), which describes the latest iteration of Google&rsquo;s in-house metrics system.</p><p><a href=https://google.aip.dev/>Google’s API Improvement Proposals (AIP)</a>. A collection of design documents that summarize Google&rsquo;s API design decisions.</p><footer class=meta><time datetime=2022-05-31T12:00:00Z>May 31, 2022</time><a class=tag href=/notes/bookmarks/>bookmarks</a><a class=tag href=/notes/google/>google</a><a class=tag href=/notes/postgresql/>postgresql</a><a class=tag href=/notes/rust/>rust</a></footer></article><article class=article data-weight=0 data-word-count=800 data-reading-time=4><header class=section-head><h2><a href=/notes/2022/05/a-real-life-use-case-for-generics-in-go-api-for-client-side-pagination/>A real life use-case for generics in Go: API for client-side pagination</a></h2></header><p>Let&rsquo;s say we have a RESTful API for a general ledger, with the endpoints, that return a paginated collection of resources:</p><ol><li><code>GET /accounts</code>, retrieves a list of accounts, filtered and sorted by some query parameters;</li><li><code>GET /accounts/:uuid/transactions</code>, retrieves a list of transactions for account;</li><li><code>GET /postings</code>, retrieves a list of <a href=https://en.wikipedia.org/wiki/Double-entry_bookkeeping>postings</a> stored in the ledger.</li></ol><p><a href=/notes/2022/05/a-real-life-use-case-for-generics-in-go-api-for-client-side-pagination/>No, this one isn't about data-structures...</a></p><footer class=meta><time datetime=2022-05-17T12:00:00Z>May 17, 2022</time><a class=tag href=/notes/go/>Go</a></footer></article><article class=article data-weight=0 data-word-count=300 data-reading-time=2><header class=section-head><h2><a href=/notes/2022/04/bookmarks-2/>Bookmarks (issue 2)</a></h2></header><p><a href=https://en.wikipedia.org/wiki/Digital_object_identifier>Digital object identifier (DOI)</a> (Wikipedia). A DOI is a persistent identifier or handle used to identify various objects uniquely. It aims to be &ldquo;resolvable&rdquo;, usually to some form of access to the information object to which the DOI refers. This is achieved by binding the DOI to metadata about the object, such as a URL. Thus, by being actionable and interoperable, a DOI differs from identifiers such as ISBNs, which aim only to identify their referents uniquely.</p><p><a href=https://principledgraphql.com/operations>Operations principles: securely deploying the graph to production at scale</a> (Principled GraphQL). Lots of things listed there apply to any sort of APIs — not only to GraphQL.</p><p><a href="https://www.youtube.com/watch?v=Dvb7ooaFJaU">Songs your English teacher will NEVER teach!</a> (Learn English with Papa Teach Me). Vocabulary from &ldquo;Savage&rdquo;, &ldquo;WAP&rdquo;, and &ldquo;34+35&rdquo;. This video is <em>definitely</em> not for kids!</p><p><a href=https://www.grammarly.com/blog/phrases-spring-clean/>8 phrases to spring-clean from your emails</a> (Grammarly).</p><p><a href=https://www.acquired.fm/episodes/platforms-and-power-with-hamilton-helmer-and-chenyi-shi>Platforms and Power</a> (Acquired). &ldquo;7 Powers&rdquo; author Hamilton Helmer and Chenyi Shi (Strategy Capital), joined Acquired Podcast to discuss platform businesses, and how the &ldquo;Power&rdquo; framework applies to them.</p><p><a href=https://medium.com/@matryer/halfthings-a8c72365617c>Halfthings</a> (<a href=https://twitter.com/matryer/>Mat Ryer</a>).
Building something for the users to play with, to touch, to feel, to break, makes all the difference and moves the conversations away from the meta.
Doing &ldquo;one thing&rdquo; or &ldquo;building an MVP&rdquo; can easily pull you into a &ldquo;too much&rdquo; for a validation phase. Build a &ldquo;<em>halfthing</em>&rdquo; instead.</p><footer class=meta><time datetime=2022-04-30T12:00:00Z>April 30, 2022</time><a class=tag href=/notes/bookmarks/>bookmarks</a><a class=tag href=/notes/graphql/>graphql</a><a class=tag href=/notes/english/>english</a><a class=tag href=/notes/random/>random</a></footer></article><article class=article data-weight=0 data-word-count=200 data-reading-time=1><header class=section-head><h2><a href=/notes/2022/03/bookmarks-1/>Bookmarks (issue 1)</a></h2></header><p><a href=https://planetscale.com/blog/generics-can-make-your-go-code-slower>Generics can make your Go code slower</a> (PlanetScale):</p><ol><li>boxing vs monomorphization vs partial monomorphization (&ldquo;GCShape stenciling with Dictionaries&rdquo;)</li><li>interface inlining doesn&rsquo;t work well with the 1.18&rsquo;s compiler</li><li>generics work well for byte sequences (<code>string | []byte</code>)</li><li>in simple cases, generics can be useful for function callbacks.</li></ol><p><a href=https://engineering.fb.com/2022/03/30/security/de-identified-authentication-at-scale/>How Meta enables de-identified authentication at scale</a>. The rational, the use-cases, and a high-level architecture of Meta&rsquo;s Anonymous Credential Service (ACS).</p><p><a href=https://aws.amazon.com/blogs/database/hidden-dangers-of-duplicate-key-violations-in-postgresql-and-how-to-avoid-them/>Hidden dangers of duplicate key violations in PostgreSQL</a> (AWS). <code>INSERT … ON CONFLICT</code> has additional benefits, if compared to relying on PostgreSQL&rsquo;s &ldquo;duplicate key violation&rdquo; error:</p><ol><li>no additional space needed for dead tuples</li><li>less autovacuum required</li><li>transaction IDs aren&rsquo;t used for nothing, preventing (postponing) the potential trx-id wraparound.</li></ol><p><a href=https://aws.amazon.com/blogs/containers/diving-into-iam-roles-for-service-accounts/>Diving into AWS IAM Roles for (Kubernetes) Service Accounts (IRSA)</a>.</p><footer class=meta><time datetime=2022-03-31T12:00:00Z>March 31, 2022</time><a class=tag href=/notes/bookmarks/>bookmarks</a><a class=tag href=/notes/go/>Go</a><a class=tag href=/notes/postgresql/>postgresql</a><a class=tag href=/notes/aws/>aws</a><a class=tag href=/notes/kubernetes/>kubernetes</a></footer></article><article class=article data-weight=0 data-word-count=300 data-reading-time=2><header class=section-head><h2><a href=/notes/2022/02/go-talks-i-keep-coming-back-to/>Go talks I keep coming back to</a></h2></header><p>I have a personal list of &ldquo;top conference talks&rdquo; that I keep referring back to, even after years of working with Go:</p><ul><li><strong><a href="https://www.youtube.com/watch?v=3RkRpS2UV80">Go profiling from bottom up</a></strong>, <a href=https://github.com/felixge>Felix Geisendörfer</a>, GoLab 2021. Felix explains what&rsquo;s under the hood of Go&rsquo;s pprof.</li><li><strong><a href="https://www.youtube.com/watch?v=S_1YfTfuWmo">Evolving the Go Memory Manager&rsquo;s RAM and CPU Efficiency</a></strong>, Michael Knyszek, GopherCon 2020</li><li><strong><a href="https://www.youtube.com/watch?v=h0s8CWpIKdg">Death by 3,000 Timers: Streaming Video-on-Demand for Cable TV</a></strong>, <a href=https://twitter.com/chris_csguy>Chris Hines</a>, GopherCon 2019. Chris explains the mechanics behind the Go runtime scheduler, following the anomaly cases, they observed, when ran a Go application on a physical machine, with large number of CPU cores.</li><li><strong><a href="https://www.youtube.com/watch?v=5zXAHh5tJqQ">Rethinking Classical Concurrency Patterns</a></strong> (<a href=https://drive.google.com/file/d/1nPdvhB0PutEJzdCq5ms6UI58dp50fcAN/view>Slides</a>), <a href=https://github.com/bcmills>Bryan C. Mills</a>, GopherCon 2018. Brian demos the implementation of typical concurrency patterns, following the famous Go proverb: &ldquo;Don&rsquo;t communicate by sharing memory; share memory by communicating.&rdquo;</li><li><strong><a href="https://www.youtube.com/watch?v=ZfdF8gPinlU">GoLab Keynote</a></strong>, <a href=https://twitter.com/goinggodotnet>Bill Kennedy</a>, GoLab 2018. Bill demoes the ways to reason about the performance of a Go application, with the help of Go runtime tracer.</li><li><strong><a href="https://www.youtube.com/watch?v=YHRO5WQGh0k">The Scheduler Saga</a></strong>, Kavya Joshi, GopherCon 2018. Kavya shows what stands behind the magic of Go runtime.</li><li><strong><a href="https://www.youtube.com/watch?v=1v3RilVOTKM">Restarting Go applications gracefully</a></strong> (<em>in Russian</em>), <a href=https://sergey.kamardin.org/>Сергей Камардин</a>, GopherCon Russia 2018</li><li><strong><a href="https://www.youtube.com/watch?v=8hQG7QlcLBk">Advanced Testing with Go</a></strong>, <a href=https://twitter.com/mitchellh>Mitchell Hashimoto</a>, GopherCon 2017</li><li><strong><a href="https://www.youtube.com/watch?v=KBZlN0izeiY">Understanding Channels</a></strong>, Kavya Joshi, GopherCon 2017. Kavya explains how channels work under the hood.</li></ul><p>Keeping the list here, in public, should help my future self, in a situation where I&rsquo;m stuck with a <em>mind-blocker</em>, and I need to quickly pull out a piece of community wisdom from the backyards of my memory. The list isn&rsquo;t meant to be complete, and I expect to add more links here, moving forward.</p><p><em>Did I miss any? Share your suggestions with me on <a href=https://twitter.com/tvii/status/1491136758792155139>Twitter</a>.</em></p><footer class=meta><time datetime=2022-02-08T12:00:00Z>February 8, 2022</time><a class=tag href=/notes/bookmarks/>bookmarks</a><a class=tag href=/notes/go/>Go</a></footer></article><article class=article data-weight=0 data-word-count=100 data-reading-time=1><header class=section-head><h2><a href=/notes/2022/02/love-hate-material/>Love. Hate. Material Design</a></h2></header><p>If Chrome had a notch</p><figure><img src=/images/2022/material-chrome-cut-1x.jpg alt="Chrome notch" width=1000></figure><p><a href=/notes/2022/02/love-hate-material/>Another witty picture under the cut…</a></p><footer class=meta><time datetime=2022-02-02T12:00:00Z>February 2, 2022</time><a class=tag href=/notes/material-design/>material design</a><a class=tag href=/notes/random/>random</a></footer></article><article class=article data-weight=0 data-word-count=1500 data-reading-time=7><header class=section-head><h2><a href=/notes/2022/01/i-got-covid/>I've got COVID. What do I do next?</a></h2></header><p>Go to <a href=https://www.berlin.de/corona/massnahmen/abstands-und-hygieneregeln/>https://www.berlin.de/corona/massnahmen/abstands-und-hygieneregeln/</a> for the information (in German) about the latest regulations in Berlin. For the up-to-date information in your region, consult with your local authorities.</p><p><em>Everything I list below are the steps I found relevant, after I&rsquo;ve self-tested positive for COVID in Berlin, in the end of January 2022</em>.</p><h3 id=friday-28th-january-2022>Friday, 28th January 2022</h3><p>I woke up with some <em>mild</em> symptoms of cold. On the day before I worked from home, and only had a usual an hour-long walk around Prenzlauer Berg — Mitte after the workday. The rapid antigen test (<em>Schnelltest</em>) was negative.</p><p>While still working from home, I took a &ldquo;quiet Friday&rdquo; at work, to simply focused on some mundane routines.</p><p>I went for a short walk in the afternoon, bought some grocery, and headed home.</p><h3 id=saturday-29th-january>Saturday, 29th January</h3><p>Didn&rsquo;t feel anywhere better or worse: mostly had a runny nose and a dry throat. I didn&rsquo;t want to wait in the line for a quick-test, so I&rsquo;ve just walked around the city for an hour and went home.</p><h3 id=sunday-30th-january>Sunday, 30th January</h3><p>It felt the same as it&rsquo;d been the day before, although the dry throat started to feel a bit more intense. Walked around for an hour, came home, made some coffee ;)</p><p>A couple hours later I started to cough. I made a self-test — we still had some at home — and,</p><blockquote><p><em>Here we are! Welcome to the &ldquo;two-stripes&rdquo; club</em>.</p></blockquote><p><a href=/notes/2022/01/i-got-covid/>Keep reading…</a></p><footer class=meta><time datetime=2022-01-31T12:00:00Z>January 31, 2022</time><a class=tag href=/notes/berlin/>berlin</a><a class=tag href=/notes/covid-19/>COVID-19</a></footer></article><article class=article data-weight=0 data-word-count=200 data-reading-time=1><header class=section-head><h2><a href=/notes/2021/12/error-messages-in-go/>Error messages in Go</a></h2></header><p>When Go code propagates an error, the following pattern is very popular:</p><pre tabindex=0><code>fmt.Errorf(&#34;failed to find a parking slot: %w&#34;, err)
// Or
fmt.Errorf(&#34;could not call mom: %w&#34;, err)
</code></pre><p>These &ldquo;could not&rdquo;, &ldquo;failed to&rdquo;, &ldquo;unable to&rdquo; make sense when my mind is in the local context of the function, method or package. But, in most of the cases I have to deal with, it makes the resulting log message overloaded with informational garbage:</p><pre tabindex=0><code>unable to ask about the cat: failed to call mom: failed to do request: Get https://: context canceled
</code></pre><p>While discussing this issue with a colleague, we came up with the following &ldquo;better&rdquo; strategy:</p><ol><li>only the logger should express its attitude to the facts, using words &ldquo;error&rdquo;, &ldquo;failed&rdquo;, etc</li><li>the business code must operate only with facts, e.g. &ldquo;call mom&rdquo;.</li></ol><pre tabindex=0><code>err := CallMom(number)
if err != nil {
    return fmt.Errorf(&#34;call mom (tel %s): %w&#34;, number, err)
}
</code></pre><p>This renders as following to the application logs:</p><pre tabindex=0><code>error: ask about cat: call mom (tel 123): make request: Get https://: context canceled
</code></pre><p>For a long stack of errors, this makes the full error message more dense, showing more useful information per line.</p><footer class=meta><time datetime=2021-12-30T12:00:00Z>December 30, 2021</time><a class=tag href=/notes/go/>Go</a></footer></article><nav class=pagination><span class="page-item page-item-active" aria-current=page aria-label="Page 1">1</span>
<a class=page-item href=/notes/page/2/ aria-label="Page 2">2</a>
<a class=page-item href=/notes/page/3/ aria-label="Page 3">3</a></nav></main><footer class=site-footer>#НетВойне<br><a href=mailto:vladimir@varank.in>vladimir@varank.in</a></footer><img src=https://c.varank.in/hello/*https://vladimir.varank.in/notes/ style=position:absolute;left:-9999px decoding=async alt></body></html>